-- Drop tables if they exist (clean start)
DROP TABLE IF EXISTS projects;
DROP TABLE IF EXISTS employees;
DROP TABLE IF EXISTS departments;

-- Departments table
CREATE TABLE departments (
    dept_id INT AUTO_INCREMENT PRIMARY KEY,
    dept_name VARCHAR(50) NOT NULL
);

-- Employees table
CREATE TABLE employees (
    emp_id INT AUTO_INCREMENT PRIMARY KEY,
    emp_name VARCHAR(50) NOT NULL,
    salary DECIMAL(10,2),
    dept_id INT,
    CONSTRAINT fk_employees_dept
        FOREIGN KEY (dept_id) REFERENCES departments(dept_id)
        ON DELETE CASCADE
);

-- Projects table
CREATE TABLE projects (
    project_id INT AUTO_INCREMENT PRIMARY KEY,
    project_name VARCHAR(50),
    emp_id INT,
    CONSTRAINT fk_projects_emp
        FOREIGN KEY (emp_id) REFERENCES employees(emp_id)
        ON DELETE CASCADE
);

-- Insert sample data

-- Departments
INSERT INTO departments (dept_name) VALUES
('IT'),
('HR'),
('Finance');

-- Employees
INSERT INTO employees (emp_name, salary, dept_id) VALUES
('Ahmed', 7000, 1),
('Sara', 9000, 1),
('Omar', 5000, 2),
('Laila', 8000, 3);

-- Projects
INSERT INTO projects (project_name, emp_id) VALUES
('Website Redesign', 1),
('Payroll System', 2),
('Recruitment Portal', 3),
('Budget Analysis', 4);




SELECT * FROM employees;
SELECT emp_name, salary FROM employees WHERE salary > 6000;


UPDATE employees SET salary = 9500 WHERE emp_name = 'Ahmed';

DELETE FROM employees WHERE emp_name = 'Omar';




-- subquery
SELECT emp_name, salary
FROM employees
WHERE salary > (SELECT AVG(salary) FROM employees);


SELECT dept_name
FROM departments
WHERE dept_id = (
  SELECT dept_id FROM employees
  GROUP BY dept_id
  ORDER BY AVG(salary) DESC
  LIMIT 1
);




-- inner join
SELECT e.emp_name, d.dept_name
FROM employees e
INNER JOIN departments d ON e.dept_id = d.dept_id;


-- left join
SELECT e.emp_name, p.project_name
FROM employees e
LEFT JOIN projects p ON e.emp_id = p.emp_id;


